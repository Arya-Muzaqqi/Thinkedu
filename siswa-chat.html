<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Chat Guru - Thinkedu</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <style>
        .select-wrapper {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        /* WRAPPER PILIH */
.select-wrapper {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  margin-bottom: 20px;
}

.select-wrapper label {
  font-weight: 600;
  display: block;
  margin-bottom: 8px;
}

.select-wrapper select {
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid #ccc;
  width: 100%;
  font-family: 'Poppins', sans-serif;
}

/* CHAT BOX */
.chat-box {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  max-height: 400px;
  overflow-y: auto;
  margin-bottom: 20px;
}

/* PESAN */
.chat-message {
  margin: 12px 0;
}

.chat-message .bubble {
  display: inline-block;
  padding: 10px 14px;
  border-radius: 16px;
  background: #e0f7fa;
  max-width: 70%;
  word-wrap: break-word;
}

.chat-message.me {
  text-align: right;
}

.chat-message.me .bubble {
  background: #2196f3;
  color: #fff;
}

/* FORM INPUT & BUTTON */
.chat-form {
  display: flex;
  gap: 10px;
}

.chat-form input {
  flex: 1;
  padding: 10px 14px;
  border-radius: 16px; /* Sama seperti bubble */
  border: 1px solid #ccc;
  font-family: 'Poppins', sans-serif;
}

.chat-form button {
  padding: 10px 20px;
  background: #2196f3;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.chat-form button:hover {
  background: #1976d2;
}

    </style>
</head>

<body class="dashboard">

    <aside class="sidebar">
        <img src="assets/images/logo.png" alt="Logo Thinkedu" class="logo">
        <ul>
            <li><a href="dashboard-siswa.html"><i class="fas fa-home"></i> Beranda</a></li>
            <li><a href="siswa-kelas.html"><i class="fas fa-chalkboard-teacher"></i> Kelas</a></li>
            <li><a href="siswa-jadwal.html"><i class="fas fa-calendar-alt"></i> Jadwal</a></li>
            <li><a href="siswa-tugas.html"><i class="fas fa-tasks"></i> Tugas</a></li>
            <li><a href="siswa-buku.html"><i class="fas fa-book"></i> Buku Bacaan</a></li>
            <li><a href="loyalty-point.html"><i class="fas fa-star"></i> Loyalty Point</a></li>
            <li><a href="laporan-belajar.html"><i class="fas fa-chart-line"></i> Laporan Belajar</a></li>
            <li><a href="siswa-chat.html"><i class="fas fa-comments"></i> Chat Guru</a></li>
            <li><a href="siswa-notifikasi.html">
         <span class="icon-badge">
         <i class="fas fa-bell"></i>
         <span class="badge">2</span>
         </span>Notifikasi</a>
      </li>
            <li><a href="index.html"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
    </aside>

    <main class="content">
        <header>
            <h1>Chat Guru</h1>
            <p>Pilih guru & mata pelajaran terlebih dahulu</p>
        </header>

        <section class="select-wrapper">
  <label for="mapelSelect">Pilih Mata Pelajaran:</label>
  <select id="mapelSelect">
    <option value="">-- Pilih Mata Pelajaran --</option>
    <option value="Matematika">Matematika</option>
    <option value="Fisika">Fisika</option>
    <option value="Kimia">Kimia</option>
  </select>
</section>

<section class="select-wrapper" id="guruWrapper" style="display: none;">
  <label for="guruSelect">Pilih Guru:</label>
  <select id="guruSelect">
    <option value="">-- Pilih Guru --</option>
    <option value="Bu Budi" data-mapel="Matematika">Bu Budi</option>
    <option value="Pak Tono" data-mapel="Fisika">Pak Tono</option>
    <option value="Bu Lestari" data-mapel="Kimia">Bu Lestari</option>
  </select>
</section>

<section id="chatSection" style="display: none;">
  <div class="chat-box" id="chatBox"></div>
  <form class="chat-form" id="chatForm">
    <input type="text" id="messageInput" placeholder="Tulis pesan..." required>
    <button type="submit">Kirim</button>
  </form>
</section>

    </main>

    <script>
        const mapelSelect = document.getElementById("mapelSelect");
        const guruSelect = document.getElementById("guruSelect");
        const guruWrapper = document.getElementById("guruWrapper");
        const chatBox = document.getElementById("chatBox");
        const chatForm = document.getElementById("chatForm");
        const messageInput = document.getElementById("messageInput");
        const chatSection = document.getElementById("chatSection");

        let selectedGuru = "";
        let selectedMapel = "";


        mapelSelect.addEventListener("change", () => {
        const mapel = mapelSelect.value;
            if (mapel) {
                guruWrapper.style.display = "block";
    // Isi ulang guru berdasarkan mapel
                let options = `<option value="">-- Pilih Guru --</option>`;
        if (mapel === "Matematika") {
                options += `<option value="Bu Ria|Matematika">Bu Ria</option>`;
            } else if (mapel === "Fisika") {
                options += `<option value="Pak Budi|Fisika">Pak Budi</option>`;
            } else if (mapel === "Kimia") {
                options += `<option value="Bu Lestari|Kimia">Bu Lestari</option>`;
            }
                guruSelect.innerHTML = options;
                chatSection.style.display = "none";
                chatBox.innerHTML = "";
        } else {
            guruWrapper.style.display = "none";
            chatSection.style.display = "none";
            chatBox.innerHTML = "";
        }
    });

            guruSelect.addEventListener("change", () => {
            const val = guruSelect.value;
        if (val) {
            [selectedGuru, selectedMapel] = val.split("|");
                chatSection.style.display = "block";
                loadChat();
        } else {
                chatSection.style.display = "none";
                chatBox.innerHTML = "";
        }
    });

    </script>

    <script>

  mapelSelect.addEventListener("change", () => {
    const selectedMapel = mapelSelect.value;
    if (selectedMapel) {
      // Tampilkan dropdown guru sesuai mapel
      guruWrapper.style.display = "block";
      // Filter opsi guru
      for (const option of guruSelect.options) {
        const mapel = option.dataset.mapel;
        if (!mapel || mapel === selectedMapel) {
          option.style.display = "block";
        } else {
          option.style.display = "none";
        }
      }
    } else {
      guruWrapper.style.display = "none";
      chatSection.style.display = "none";
    }
  });

  guruSelect.addEventListener("change", () => {
    if (guruSelect.value) {
      chatSection.style.display = "block";
    } else {
      chatSection.style.display = "none";
    }
  });

  chatForm.addEventListener("submit", function (e) {
    e.preventDefault();
    const pesan = messageInput.value.trim();
    if (!pesan) return;

    const bubble = document.createElement("div");
    bubble.className = "chat-message me";
    bubble.innerHTML = `<div class="bubble">${pesan}</div>`;
    chatBox.appendChild(bubble);

    messageInput.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;
  });
</script>

</body>

</html>