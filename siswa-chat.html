<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Chat Guru - Thinkedu</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <style>

      body.dashboard {
            background: url('assets/images/background.png') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .sidebar {
          width: 240px;
          height: 100vh; /* penuh tinggi layar */
          background-color: rgba(255, 255, 255, 0.9);
          box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
          display: flex;
          flex-direction: column;
          overflow-y: auto; /* ini bikin bisa digulir */
          padding: 20px 0; /* atas-bawah */

        }

        .sidebar img.logo {
            width: 200px;
            display: block;
            margin: 0 auto 10px;
        }

        .sidebar h2 {
            text-align: center;
            font-size: 18px;
            margin-bottom: 30px;
        }

        .sidebar ul {
            list-style: none;
            padding: 0 0 20px 0 ;
            margin: 0;
        }

        .sidebar ul li {
            margin: 15px 0;
        }

        .sidebar ul li a {
            color: #333;
          text-decoration: none;
          transition: background 0.3s, color 0.3s;
          border-radius: 4px;
          display: block;
          padding: 8px 16px; /* ini yang bikin nyaman */
        }
        
        .sidebar ul li a:hover {
            background: #2196F3;
            color: #fff;

        }
        .content {
            flex: 1;
            padding: 40px;
            background-color: rgba(255, 255, 255, 0.7);
        }


    header h1 {
      margin: 0 0 5px 0;
    }

    header p {
      margin: 0 0 20px 0;
      color: #555;
    }
        .select-wrapper {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        /* WRAPPER PILIH */
.select-wrapper {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  margin-bottom: 20px;
}

.select-wrapper label {
  font-weight: 600;
  display: block;
  margin-bottom: 8px;
}

.select-wrapper select {
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid #ccc;
  width: 100%;
  font-family: 'Poppins', sans-serif;
}

/* CHAT BOX */
.chat-box {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  max-height: 400px;
  overflow-y: auto;
  margin-bottom: 20px;
}

/* PESAN */
.chat-message {
  margin: 12px 0;
}

.chat-message .bubble {
  display: inline-block;
  padding: 10px 14px;
  border-radius: 16px;
  background: #e0f7fa;
  max-width: 70%;
  word-wrap: break-word;
}

.chat-message.me {
  text-align: right;
}

.chat-message.me .bubble {
  background: #2196f3;
  color: #fff;
}

/* FORM INPUT & BUTTON */
.chat-form {
  display: flex;
  gap: 10px;
}

.chat-form input {
  flex: 1;
  padding: 10px 14px;
  border-radius: 16px; /* Sama seperti bubble */
  border: 1px solid #ccc;
  font-family: 'Poppins', sans-serif;
}

.chat-form button {
  padding: 10px 20px;
  background: #2196f3;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
}

.chat-form button:hover {
  background: #1976d2;
}

.popup-error {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ffebee;
            border: 2px solid #f44336;
            color: #c62828;
            padding: 20px 30px;
            border-radius: 12px;
            font-weight: bold;
            display: none;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
.chat-form .btn-fail-sim {
    background: #f44336; /* Warna merah untuk gagal */
    /* Kita tidak perlu mengulang padding, border, color, dll. karena sudah mewarisi dari .chat-form button */
}

.chat-form .btn-fail-sim:hover {
    background: #d32f2f; /* Warna merah lebih gelap saat hover */
}
    </style>
</head>

<body class="dashboard">

    <aside class="sidebar">
        <img src="assets/images/logobaru.png" alt="Logo Thinkedu" class="logo">
        <ul>
            <li><a href="dashboard-siswa.html"><i class="fas fa-home"></i> Beranda</a></li>
            <li><a href="siswa-kelas.html"><i class="fas fa-chalkboard-teacher"></i> Kelas</a></li>
            <li><a href="siswa-jadwal.html"><i class="fas fa-calendar-alt"></i> Jadwal</a></li>
            <li><a href="siswa-tugas.html"><i class="fas fa-tasks"></i> Tugas</a></li>
            <li><a href="siswa-buku.html"><i class="fas fa-book"></i> Buku Bacaan</a></li>
            <li><a href="loyalty-point.html"><i class="fas fa-star"></i> Loyalty Point</a></li>
            <li><a href="laporan-belajar.html"><i class="fas fa-chart-line"></i> Laporan Belajar</a></li>
            <li><a href="siswa-chat.html"><i class="fas fa-comments"></i> Chat Guru</a></li>
            <li><a href="siswa-notifikasi.html">
         <span class="icon-badge">
         <i class="fas fa-bell"></i>
         <span class="badge">2</span>
         </span>Notifikasi</a>
      </li>
      <li><a href="siswa-profil.html"><i class="fas fa-user"></i> Profil</a></li>
            <li><a href="index.html"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
    </aside>

    <main class="content">
        <header>
            <h1>Chat Guru</h1>
            <p>Pilih guru & mata pelajaran terlebih dahulu</p>
        </header>

        <section class="select-wrapper">
  <label for="mapelSelect">Pilih Mata Pelajaran:</label>
  <select id="mapelSelect">
    <option value="">-- Pilih Mata Pelajaran --</option>
    <option value="Matematika">Matematika</option>
    <option value="Fisika">Fisika</option>
    <option value="Kimia">Kimia</option>
  </select>
</section>

<section class="select-wrapper" id="guruWrapper" style="display: none;">
  <label for="guruSelect">Pilih Guru:</label>
  <select id="guruSelect">
    <option value="">-- Pilih Guru --</option>
    <option value="Bu Budi" data-mapel="Matematika">Bu Budi</option>
    <option value="Pak Tono" data-mapel="Fisika">Pak Tono</option>
    <option value="Bu Lestari" data-mapel="Kimia">Bu Lestari</option>
  </select>
</section>

<section id="chatSection" style="display: none;">
  <div class="chat-box" id="chatBox"></div>
  <form class="chat-form" id="chatForm">
    <input type="text" id="messageInput" placeholder="Tulis pesan..." required>
    <button type="submit">Kirim</button>
    <button type="button" class="btn-fail-sim" onclick="tampilGagal()">Simulasi Gagal</button>
  </form>
</section>

    </main>
    <div class="popup-error" id="popupError">
        ‚ùå Gagal mengirim pesan.<br>Periksa koneksi internet Anda.
    </div>
    <script>
        const mapelSelect = document.getElementById("mapelSelect");
        const guruSelect = document.getElementById("guruSelect");
        const guruWrapper = document.getElementById("guruWrapper");
        const chatBox = document.getElementById("chatBox");
        const chatForm = document.getElementById("chatForm");
        const messageInput = document.getElementById("messageInput");
        const chatSection = document.getElementById("chatSection");

        let selectedGuru = "";
        let selectedMapel = "";


        mapelSelect.addEventListener("change", () => {
        const mapel = mapelSelect.value;
            if (mapel) {
                guruWrapper.style.display = "block";
    // Isi ulang guru berdasarkan mapel
                let options = `<option value="">-- Pilih Guru --</option>`;
        if (mapel === "Matematika") {
                options += `<option value="Bu Ria|Matematika">Bu Ria</option>`;
            } else if (mapel === "Fisika") {
                options += `<option value="Pak Budi|Fisika">Pak Budi</option>`;
            } else if (mapel === "Kimia") {
                options += `<option value="Bu Lestari|Kimia">Bu Lestari</option>`;
            }
                guruSelect.innerHTML = options;
                chatSection.style.display = "none";
                chatBox.innerHTML = "";
        } else {
            guruWrapper.style.display = "none";
            chatSection.style.display = "none";
            chatBox.innerHTML = "";
        }
    });

            guruSelect.addEventListener("change", () => {
            const val = guruSelect.value;
        if (val) {
            [selectedGuru, selectedMapel] = val.split("|");
                chatSection.style.display = "block";
                loadChat();
        } else {
                chatSection.style.display = "none";
                chatBox.innerHTML = "";
        }
    });

  chatForm.addEventListener("submit", function (e) {
    e.preventDefault();
    const pesan = messageInput.value.trim();
    if (!pesan) return;

    const bubble = document.createElement("div");
    bubble.className = "chat-message me";
    bubble.innerHTML = `<div class="bubble">${pesan}</div>`;
    chatBox.appendChild(bubble);

    messageInput.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;
  });

  function tampilGagal() {
            const popup = document.getElementById("popupError");
            popup.style.display = "block";
            setTimeout(() => {
                popup.style.display = "none";
            }, 3000);
        }
</script>


</body>

</html>